# 7장. 코딩하는 동안

#### 파충류의 뇌에 귀기울이기

* 본능이란 무의식 속에 채워져 있는 패턴에 대한 단순한 반응이다.
  * 일단 본능이 반응하고 있음을 인지하고 왜 그러한 느낌이 드는지 알아내야 한다.

#### 우연에 맡기는 프로그래밍

* 행운과 우연한 성공에 의존하는 프로그래밍을 하지 않아야 한다.
  * 대신, 의도적으로 프로그래밍 해야 한다.
* 코드가 왜 망가졌는지 모르는 이유는 애초에 코드가 왜 잘 돌아가는지도 몰랐기 때문이다.
* 우연에 기대다 보면 결국 문서화되지 않은 에러나 예외적인 동작에 의존하게 된다.
  * 그저 제대로 돌아가는듯이 보이는 것일수도 있다.
  * 의존하는 조건이 단지 우연인 경우도 있다.
  * 문서화되지 않은 동작은 라이브러리의 다음 릴리즈에서 변경될 수도 있다.
  * 불필요한 추가 호출은 코드를 더 느리게 만들거나 버그를 만들 수 있다.
* 의도적으로 프로그래밍하는 방법
  * 언제나 내가 지금 무엇을 하고 있는지 알아야 한다.
  * 더 경험이 적은 프로그래머에게 코드를 상세히 설명할 수 있는가?
  * 자신도 잘 모르는 코드를 만들지 말라.
  * 계획을 세우고 이를 바탕으로 진행하라
  * 신뢰할 수 있는 것에만 기대라.
  * 가정을 기록으로 남겨라.
  * 코드뿐 아니라 내가 세운 가정도 테스트 해보아야 한다. 어떤 일이든 추측만 하지 말고 실제로 시험해보라.
  * 과거의 노예가 되지 말라. 기존 코드가 더는 적절하지 않다 싶으면 언제나 리팩터링할 자세가 되어 있어야 한다.

#### 리팩터링

* 소프트웨어 개발은 건축보다 정원가꾸기에 더 가깝다.
* 리팩토링은 언제 하는가?
  * 무엇이든 잘못되었다는 생각이 들 때 주저하지 말고 변경하라.
  * 리팩토링은 고통 관리를 실천하는 것이다. 현실을 피하지 말고 리팩토링 하라.
* 일찍 리팩터링하고 자주 리팩터링 하라.
  * 일정의 압박은 리팩토링을 하지 않는 단골 핑계다. 그러나 나중에는 훨씬 더 많은 시간을 투자해야 한다.
* 리팩터링은 어떻게 하는가?
  * 리팩터링과 기능 추가를 동시에 하지 말라.
  * 리팩터링을 시작하기 전 든든한 테스트가 있는지 먼저 확인하라.
  * 할수 있는 한 자주 테스트를 돌려서 바꾼 것때문에 무언가 망가졌을 경우 재빨리 알아채라
  * 단계를 작게 나누고 단계가 끝날때마다 테스트를 돌리며 신중하게 작업하라.
* 깨진 창문을 그대로 놓아두지 말라.

#### 테스트로 코딩하기

* 테스트는 버그를 찾기 위한 것이 아니다.
  * 테스트의 주요한 이득은 테스트를 실행할 때가 아니라, 테스트에 대해 생각하고 테스트를 작성할 때 생긴다.
* 테스트가 코드의 첫번째 사용자다.
  * 테스트는 우리의 코딩을 인도하는 필수 피드백이다.
  * 무언가를 테스트하기 좋게 만들면 결합도도 낮아진다.
  * 게다가 무언가를 테스트하려면 그것을 이해해야만 한다.
* 테스트 주도 개발
  * TDD의 핵심은 반복 주기가 기껏해야 몇분 정도로 매우 짧아야 한다는 것이다.
  * TDD는 큰 효과가 있지만, 다음과 같은 징후는 조심해야 한다.
    * 늘 테스트 커버리지 100%를 달성하기 위해 과도한 시간 투자.
    * 많은 수의 중복 테스트가 생김
    * 밑에서부터 시작해 위로 올라가는 방식으로 설계함
* 모든 소프트웨어는 언젠가 테스트 된다.
  * 내가 테스트하지않으면 사용자가 테스트하게 된다.
  * 따라서 소프트웨어를 철저하게 테스트할 계획을 세우는 것이 좋다.
  * 제대로 된 테스트 문화를 가졌다면 모든 테스트가 언제나 통과해야 한다.
  * 테스트는 프로그래밍의 일부다. 다른 곳에 떠넘길 수 있는 것이 아니다.

#### 속성기반 테스트

* 속성 기반 테스트로 가정을 검증하라.
  * 코드에 존재하는 계약과 불변식을 뭉뚱그려서 속성이라고 부른다.
* 속성 기반 테스트가 강력한 이유는 입력을 생성하는 규칙과 출력을 검증하는 단정문만 설정하기 때문이다.
  * 정확히 어떤일이 일어나는지 알 수 없다.
  * 속성 기반 테스트가 실패했다면 해당 매개 변수를 알아내 별도의 단위 테스트를 정식으로 추가하는 것이 좋다.
* 속성 기반 테스트는 설계에도 도움을 준다.
  * 속성기반테스트는 코드를 불변식과 계약이라는 관점으로 바라보게 한다.

#### 바깥에서는 안전에 주의하라

* 내부에서 발생하는 오류뿐 아니라 외부에서 시스템을 망가트리려 하는 시도까지 고려하라
* 기본 보안 원칙
  * 공격 표면을 최소화하라
    * 복잡한 코드는 부작용 가능성을 높이고 공격 표면을 높인다.
    * 외부의 데이터를 절대 신뢰하지 말라.
    * 인증이 없는 서비스는 공격 매개체다.
    * 인증받은 사용자의 수를 언제나 최소로 유지하라.
    * 응답에 들어있는 데이터가 사용자의 권한에 적절한지 확인하라.
    * 디버깅 정보를 노출시키지 마라
  * 최소 권한 원칙
  * 안전한 기본값
  * 민감정보 암호화
  * 보안 업데이트 적용

#### 이름 짓기

* 프로그래밍에서는 이름이 모든 것이다.
* 이름을 지을때는 표현하고 싶은 것을 명확하게 다듬기 위해 끊임없이 노력해야 한다.
* 반드시 팀의 모든 사람이 각 단어의 뜻을 알고 일관성 있게 사용해야 한다.
* 부지런히 이름을 바꾸지 않으면 잘못된 이름을 사용하는 코드가 될 수 있다.
  * 이상한 이름을 발견하면 바로 바꿔라.
