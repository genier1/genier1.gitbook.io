# 2장. 실용주의 접근법

#### 좋은 설계의 핵심

* 좋은 설계는 나쁜 설계보다 바꾸기 쉽다.
* ETC(Easy To Change) 원칙을 따라라
  * 결합도를 줄이면 왜 좋은가? → 관심사를 분리하면 더 바꾸기 쉬워지기 때문이다.
  * 왜 단일 책임 원칙이 좋은가? → 요구 사항이 바뀌더라도 모듈 하나만 바꾸면 되기 때문이다. ETC!
* ETC에는 어떤길이 미래의 변경을 더 쉽게 만들지 안다는 암묵적인 전제가 있다.
  * 앞으로 어떤 모습으로 바뀔지 모르겠다면 작성하는 코드를 최대한 교체하기 쉽게 만들어라.
  * 이런 상황을 직관을 발전시킬 수 있는 기회로 삼아라

#### DRY: 반복하지 말라

* DRY는 코드의 중복 뿐만이 아니라 **지식의 중복, 의도의 중복**에 대한 것이다.
* 모든 코드 중복이 지식의 중복은 아니다.
  * 코드는 동일하지만 두 함수가 표현하는 지식이 다르다면, 이것은 우연이지 중복이 아니다.
* 문서화 중복
  * 코드에 대해 같은 의도의 주석이 쓰여 있다면 의도가 두번 표현된 것이다.
    * 두군데를 함께 고쳐야 하며, 시간이 지남에 따라 주석과 코드의 내용이 어긋날 것이다.
* 데이터의 DRY 위반.
  * 모듈이 자료구조를 노출하면 언제나 모듈의 구현과 그 자료구조를 사용하는 코드 사이에 결합이 생긴다
* 표현상의 중복
  * 언어나 기술에 중립적인 형식으로 내부 API를 정의할 수 있는 도구를 찾아라
  * 공개 API를 OpenAPI 같은 형식으로 엄밀하게 문서화 하는건 좋다.
* 개발자 간의 중복
  * 발견하거나 없애기 가장 어려운 중복은 같은 프로젝트에서 일하는 개발자들 사이에서 발생한다.
    * 똑같은 일을 하는 코드가 우연히 중복으로 추가되는 등등
  * 개발자 간에 적극적이고 빈번한 소통을 장려하는게 최선책이다.
    * 일일 스크럼 미팅이나 프로젝트 사서를 임명해서 해결하는 것도 방법이다.

#### 직교성

* 컴퓨터과학에서 직교성이란 일종의 독립성이나, 결합도 줄이기를 의미한다.
* 관련이 없는 것들에 대해서는 서로 영향이 없게 해야한다.
* 직교성 있는 프로그램을 개발하면 생산성이 올라가고 리스크가 감소한다.
  * 생산성 향상
    * 변화를 국소화해서 개발 시간과 테스트시간이 감소함
    * 컴포넌트를 재조합하고 개량하기 쉬움
  * 리스크 감소
    * 감염된 코드가 격리됨
    * 시스템이 잘 깨지지 않고 문제점이 한정됨
    * 특정 업체/제품/플랫폼에 덜 종속됨
* 설계가 직교적인지 확인하는 손쉬운 방법
  * 특정 기능에 대한 요구 사항을 대폭 변경할 경우 몇 개의 모듈이 영향 받는가? → 직교적인 시스템이라면 답이 하나여야 함
* 자신의 힘으로 제어할 수 없는 속성에 의존하지 마라
  * 주민번호를 유저 식별자로 사용하는 경우 → 실제로 바뀜
* 툴킷이나 라이브러리 도입시 코드에 수용해서는 안될 변화를 만드는지 검토하라
* 직교성을 유지하기 위해 코딩하는 방법들
  * 코드의 결합도를 줄여라
  * 전역 데이터를 피하라
  * 유사한 함수를 피하라 → 전략 패턴 등을 활용하라
* 자신이 작성하는 코드를 항상 비관적으로 바라보고 개선하기 위해 노력하라.
* 직교적으로 구현된 시스템은 테스트하기도 쉽다
  * 단위 테스트를 빌드하고 실행하기 위해 시스템의 상당 부분을 불러와야 한다면 결합도를 충분히 줄이지 못한 것이다.
* 버그 수정은 시스템의 직교성을 총체적으로 점검하게 한다.
  * 버그를 수정하기 위해 모듈 하나만 변경하면 되는가? 수정하고 나니 새로운 문제가 나타나는가?

#### 가역성

* 결정이 바뀌지 않을 것이라 가정하고 되돌릴 수 없는 결정을 하지 마라.
* 바꾸기 쉽게 만들어라
  * 외부 API를 추상화 계층 뒤로 숨겨라
  * 코드를 여러 컴포넌트로 쪼개라
* 유행을 쫓지 말라. 누구도 어떤 미래가 펼쳐질지 알 수 없다.

#### 도메인 언어

* 문제 도메인의 언어가 프로그래밍 해결책을 제안하기도 한다.
* 실용주의 프로그래머라면 도메인의 언어를 사용해서 프로그래밍 할 수 있다.
* 도메인 언어를 만들려면 어느정도 추가 비용이 발생한다. 절약하는 것보다 더 많은 시간을 쏟지는 말라.
* 기본적으로는 YAML, JSON 처럼 널리 통용되는 외부 언어를 사용해라. 그게 아니라면 내부 언어를 고려하라

#### 추정

* 누군가 추정치를 물었을 때, 스스로 물어보아야 할 첫번째 질문은 답변이 사용될 상황이 무엇인지다.
  * 매우 높은 정확도가 필요한가? 아니면 단순히 큰 그림을 요구하는가?
* 추정 모델에 시간을 쏟기 전에 이미 그 일을 해본 사람에게 물어봐라
* 추정치를 내는 방법
  * 무엇을 묻고 있는지 이해하라
  * 시스템의 모델을 만들어라
  * 모델을 컴포넌트로 나눠라
  * 각 매개변수에 값을 할당하고 답을 계산하라
  * 추정결과를 기록하라
* 누군가 추정해 달라고 하면 **나중에 연락드릴게요** 라고 말하라.
  * 잠시 손을 멈추고 시간을 내서 앞서 설명한 단계를 밟아나간다면 대부분의 경우 더 좋은 추정치를 얻을 것이다.
